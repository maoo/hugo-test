<!DOCTYPE html>
  
  
  
  
   <html class="no-js"> 

  <head lang="en-us">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=10" />
    <title>Architecture - Symphony Integrations official documentation</title>
    <meta name="generator" content="Hugo 0.22" />

    
    <meta name="description" content="Symphony Integrations documentation.">
    
    <link rel="canonical" href="http://blog.session.it/hugo-test/architecture/">
    
    <meta name="author" content="Symphony LLC">
    

    <meta property="og:url" content="http://blog.session.it/hugo-test/architecture/">
    <meta property="og:title" content="Symphony Integrations official documentation">
    <meta property="og:image" content="http://blog.session.it/SymphonyLlcSymbol.png">
    <meta name="apple-mobile-web-app-title" content="Symphony Integrations official documentation">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="shortcut icon" type="image/x-icon" href="http://blog.session.it/hugo-test/images/favicon.ico">
    <link rel="icon" type="image/x-icon" href="http://blog.session.it/hugo-test/images/favicon.ico">

    <style>
      @font-face {
        font-family: 'Icon';
        src: url('http://blog.session.it/hugo-test/fonts/icon.eot');
        src: url('http://blog.session.it/hugo-test/fonts/icon.eot')
               format('embedded-opentype'),
             url('http://blog.session.it/hugo-test/fonts/icon.woff')
               format('woff'),
             url('http://blog.session.it/hugo-test/fonts/icon.ttf')
               format('truetype'),
             url('http://blog.session.it/hugo-test/fonts/icon.svg')
               format('svg');
        font-weight: normal;
        font-style: normal;
      }
    </style>

    <link rel="stylesheet" href="http://blog.session.it/hugo-test/stylesheets/application.css">
    <link rel="stylesheet" href="http://blog.session.it/hugo-test/stylesheets/temporary.css">
    <link rel="stylesheet" href="http://blog.session.it/hugo-test/stylesheets/palettes.css">
    <link rel="stylesheet" href="http://blog.session.it/hugo-test/stylesheets/highlight/highlight.css">

    
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Ubuntu:400,700|Ubuntu&#43;Mono">
    <style>
      body, input {
        font-family: 'Ubuntu', Helvetica, Arial, sans-serif;
      }
      pre, code {
        font-family: 'Ubuntu Mono', 'Courier New', 'Courier', monospace;
      }
    </style>

    
    <script src="http://blog.session.it/hugo-test/javascripts/modernizr.js"></script>

    

  </head>
  <body class="palette-primary-grey palette-accent-teal">




<div class="backdrop">
	<div class="backdrop-paper"></div>
</div>

<input class="toggle" type="checkbox" id="toggle-drawer">
<input class="toggle" type="checkbox" id="toggle-search">
<label class="toggle-button overlay" for="toggle-drawer"></label>

<header class="header">
	<nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        Architecture
      </div>
    </div>

    
    <div class="button button-twitter" role="button" aria-label="Twitter">
       <a href="https://twitter.com/symphonyOSS" title="@symphonyOSS on Twitter" target="_blank" class="toggle-button icon icon-twitter"></a>
    </div>
    

    
    <div class="button button-github" role="button" aria-label="GitHub">
      <a href="https://github.com/symphonyoss" title="@symphonyoss on GitHub" target="_blank" class="toggle-button icon icon-github"></a>
    </div>
    
    
        
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
</header>

<main class="main">
	<div class="drawer">
		<nav aria-label="Navigation">
  <a href="http://blog.session.it/hugo-test" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="http://blog.session.it/hugo-test/SymphonyLlcSymbol.png">
        </div>
      
      <div class="name">
        <strong>Symphony Integrations official documentation </strong>
        
      </div>
    </div>
  </a>

  <div class="scrollable">
    <div class="wrapper">
      

      <div class="toc">
        
        <ul>
          




<li>
  
    



<a  title="Welcome" href="http://blog.session.it/hugo-test/">
	
	Welcome
</a>



  
</li>



<li>
  
    



<a class="current" title="Architecture" href="http://blog.session.it/hugo-test/architecture/">
	
	Architecture
</a>


<ul id="scrollspy">
</ul>


  
</li>



<li>
  
    <span class="section">Integrations</span>
    <ul>
      
        
        



<a  title="Github" href="http://blog.session.it/hugo-test/integrations/github">
	
	Github
</a>



      
        
        



<a  title="JIRA" href="http://blog.session.it/hugo-test/integrations/jira">
	
	JIRA
</a>



      
        
        



<a  title="Trello" href="http://blog.session.it/hugo-test/integrations/trello">
	
	Trello
</a>



      
        
        



<a  title="Salesforce" href="http://blog.session.it/hugo-test/integrations/salesforce">
	
	Salesforce
</a>



      
        
        



<a  title="Universal" href="http://blog.session.it/hugo-test/integrations/universal">
	
	Universal
</a>



      
        
        



<a  title="Zapier" href="http://blog.session.it/hugo-test/integrations/zapier">
	
	Zapier
</a>



      
    </ul>
  
</li>



<li>
  
    



<a  title="Build your own" href="http://blog.session.it/hugo-test/quickstart/">
	
	Build your own
</a>



  
</li>


        </ul>
        

        
        <hr>
        <span class="section">The author</span>
        
        <ul>
          
          <li>
            <a href="https://twitter.com/symphonyOSS" target="_blank" title="@symphonyOSS on Twitter">
              @symphonyOSS on Twitter
            </a>
          </li>
          

          
          <li>
            <a href="https://github.com/symphonyoss" target="_blank" title="@symphonyoss on GitHub">
              @symphonyoss on GitHub
            </a>
          </li>
          

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>

	</div>

	<article class="article">
		<div class="wrapper">
			<h1>Architecture </h1>

			

<p>This page guides developers to create their first Symphony Integration, also known as <strong><em>Symphony Integration Bridge</em></strong>.</p>

<h2 id="integration-bridge-architecture">Integration Bridge architecture</h2>

<p>The Integration Bridge is responsible for managing active integrations and provides key services to allow third party services the ability to post messages into a configurable set of streams</p>

<p>The key services provided to the registered integrations are:</p>

<ul>
<li>Authentication proxy - each integration should be configured with credentials, but the implementation never needs to
deal with them. Once bootstrapped, the integration can use integration bridge services as if it&rsquo;s unauthenticated. The bridge itself proxies those services to the cloud with the proper authentication.</li>
<li>Send messages to a stream</li>
<li>Read and write configuration information to the cloud configuration services</li>
<li>Read user information to the cloud user services</li>
<li>Health check</li>
</ul>

<h3 id="definitions">Definitions</h3>

<p>A list of definitions also serves to introduce the main components of the integrations system.</p>

<ul>
<li><p><strong>Integration</strong> - An interface to be implemented by an specific integration. These are bootstrapped into the
Integration Bridge via config file. They have a lifecycle to be managed by the Integration Bridge.</p></li>

<li><p><strong>Webhook Integration</strong> - A specific type of integration which can be configured to listen for specific webhook events
from external services. This is also a superclass of particular implementations of the webhook integrations which support specific services.
For instance, a Zapier webhook integration would extend this, and provide logic to translate the event information
into a particular message to the streams.</p></li>

<li><p><strong>Integration Config API</strong> - Cloud API responsible to manage the webhook instances configured by the user.</p></li>

<li><p><strong>Configurator</strong> - An application (listed in the Symphony App Store) which allows a user to
configure instances of an integration type. Using Zapier as an example, an user would have the configuration app
available in the app store, and once opened would be able to configure a new instance of the Zapier webhook
integration, get the URL for the JIRA cloud services to ping with webhook events, configure streams which the
integration instance should post to, as well as the name of the instance. The configurator app can also be used to
manage existing instances.</p></li>
</ul>

<h3 id="system-overview">System overview</h3>

<p>Following below how the message sent by third party services flows through the system overall.</p>

<p><img src="http://blog.session.it/hugo-test/Integration_Bridge_Overview.png" alt="System Overview" /></p>

<p>The message sent by the third party service is processed by the integration parser and translated to MessageML. After that, the Integration Bridge posts the result MessageML through the Agent Message API&rsquo;s.</p>

<h2 id="webhook-integration-architecture">Webhook Integration architecture</h2>

<p>In this section we&rsquo;ll detail what is the general workflow when the core receives a message from an integrated
application, let&rsquo;s say Zapier, for this example:</p>

<blockquote>
<ol>
<li>Expose an endpoint where it will receive the message.</li>
<li>Identify where this message is coming from through the URL parameters it received (configurationId and instanceId)</li>
<li>If the message is trying to reach a valid integration and a configured instance, it will delegate the message to the specific integration code implemented separately across the other Integration repositories.</li>
<li>The integration Zapier logic will now determine which event it is dealing with through the received message header parameter, and based on this will determine which <a href="#parsers">parser</a> it must use to treat the message properly.</li>
<li>The parser will then convert the message to a <a href="#the-message-ml-format">Message ML format</a>, extracting the needed information from the payload received.</li>
<li>The parsed message will return to the Integration Core and post the message to the Symphony platform</li>
</ol>
</blockquote>

<h3 id="parsers">Parsers</h3>

<p>Integrations will most of the times need a parser to work properly.
Those special classes will need to deal with the content coming from the related application, parsing this data into a format readable by the Symphony platform.</p>

<p>This format is called Symphony Message ML and it may contain a set of tags. More details below.</p>

<h3 id="the-message-ml-format">The Message ML format</h3>

<p>A Message ML is a Symphony XML format that defines XML elements and attributes necessary to compose a message that can be posted within a chat room.
The most basic message one can send may be as simple as <code>&lt;messageML&gt;simple message&lt;/messageML&gt;</code> or as detailed as it can get. What determines this is what system we are integrating with.</p>

<p>These elements and attributes will be briefly detailed in the next topics as reference. The specific integration formats can be found in their separate repositories &ldquo;Readme&rdquo; files.</p>

<h3 id="entity-messagemlv1-0">Entity (MessageMLv1.0)</h3>

<p><em>**note: MessageMLv1.0 has been superseded by MessageMLv2.0. MessageMLv1.0 is still supported, however MessageMLv2.0 will allow you to create a rich render in a more seamlessly manner, with less steps and no front end code. Please see a JIRA ticket rendered using messageMLv2.0 here for as a complex example: <a href="https://symphonyoss.atlassian.net/wiki/display/WGFOS/Single+Jira+Ticket+-+Templated+PresentationML">https://symphonyoss.atlassian.net/wiki/display/WGFOS/Single+Jira+Ticket+-+Templated+PresentationML</a> &amp; see <a href="https://github.com/symphonyoss/App-Integrations-Zapier">Zapier</a> as a simple example of a richly rendererd message.</em>**</p>

<p>An entity is a special element contained in a <code>&lt;messageML&gt;</code>, it may also be nested within other entities as another element, and so on.</p>

<p>Entities must have a &ldquo;type&rdquo; and a &ldquo;version&rdquo;, and may also have a &ldquo;name&rdquo; for itself, all of those as XML attributes.</p>

<p>The first entity in a messageML MUST have an element called &ldquo;presentationML&rdquo;.</p>

<p>The <code>&lt;presentationML&gt;</code> is a special element that must hold all content that would be otherwise drawn on Symphony by other elements, represented as a single string on its content.
This particular text must follow the rules presented <a href="https://rest-api.symphony.com/docs/message-format/">here</a>.</p>

<p>It is important that it contains matching information as it is used for visualising a message when a specific renderer is not present, on Symphony mobile apps or content export.</p>

<p>Entities may also have <code>&lt;attribute&gt;</code>s as their XML elements, which in turn must have a &ldquo;name&rdquo;, a &ldquo;type&rdquo; and a &ldquo;value&rdquo; as attributes.</p>

<p>Here&rsquo;s an example of a valid MessageML, containing all of the mentioned above:</p>

<pre><code class="language-xml">&lt;messageML&gt;
    &lt;entity type=&quot;sample.event.core&quot; version=&quot;1.0&quot;&gt;
        &lt;presentationML&gt;test message for:&lt;br/&gt;application core&lt;/presentationML&gt;
        &lt;attribute name=&quot;message&quot; type=&quot;org.symphonyoss.string&quot; value=&quot;test message&quot;/&gt;
        &lt;entity name=&quot;application&quot; type=&quot;sample.application&quot;&gt;
            &lt;attribute name=&quot;appName&quot; type=&quot;org.symphonyoss.string&quot; value=&quot;core&quot;/&gt;
        &lt;/entity&gt;
    &lt;/entity&gt;
&lt;/messageML&gt;
</code></pre>


			<aside class="copyright" role="note">
				
				&copy; 2017 Released under the Apache 2.0 license &ndash;
				
				Documentation built with
				<a href="https://www.gohugo.io" target="_blank">Hugo</a>
				using the
				<a href="http://github.com/digitalcraftsman/hugo-material-docs" target="_blank">Material</a> theme.
			</aside>

			<footer class="footer">
				

<nav class="pagination" aria-label="Footer">
  <div class="previous">
  
      <a href="http://blog.session.it/hugo-test/integrations/jira/" title="JIRA Integration">
        <span class="direction">
          Previous
        </span>
        <div class="page">
          <div class="button button-previous" role="button" aria-label="Previous">
            <i class="icon icon-back"></i>
          </div>
          <div class="stretch">
            <div class="title">
              JIRA Integration
            </div>
          </div>
        </div>
      </a>
  
  </div>

  <div class="next">
  
      <a href="http://blog.session.it/hugo-test/integrations/salesforce/" title="Salesforce Integration">
        <span class="direction">
          Next
        </span>
        <div class="page">
          <div class="stretch">
            <div class="title">
              Salesforce Integration
            </div>
          </div>
          <div class="button button-next" role="button" aria-label="Next">
            <i class="icon icon-forward"></i>
          </div>
        </div>
      </a>
  
  </div>
</nav>





			</footer>
		</div>
	</article>

	<div class="results" role="status" aria-live="polite">
		<div class="scrollable">
			<div class="wrapper">
				<div class="meta"></div>
				<div class="list"></div>
			</div>
		</div>
	</div>
</main>

    <script>
    
      var base_url = '';
      var repo_id  = '';
    
    </script>

    <script src="http://blog.session.it/hugo-test/javascripts/application.js"></script>
    

    <script>
      /* Add headers to scrollspy */
      var headers   = document.getElementsByTagName("h2");
      var scrollspy = document.getElementById('scrollspy');

      if(scrollspy) {
        if(headers.length > 0) {
          for(var i = 0; i < headers.length; i++) {
            var li = document.createElement("li");
            li.setAttribute("class", "anchor");

            var a  = document.createElement("a");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", headers[i].innerHTML);
            a.innerHTML = headers[i].innerHTML;

            li.appendChild(a)
            scrollspy.appendChild(li);
          }
        } else {
          scrollspy.parentElement.removeChild(scrollspy)
        }


        /* Add permanent link next to the headers */
        var headers = document.querySelectorAll("h1, h2, h3, h4, h5, h6");

        for(var i = 0; i < headers.length; i++) {
            var a = document.createElement("a");
            a.setAttribute("class", "headerlink");
            a.setAttribute("href", "#" + headers[i].id);
            a.setAttribute("title", "Permanent link")
            a.innerHTML = "#";
            headers[i].appendChild(a);
        }
      }
    </script>

    

    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </body>
</html>

